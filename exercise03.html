<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Tap Label → Tap Box – Categorize Points (Mobile Friendly)</title>

<style>
:root{
  --bg:#0b1220;
  --panel: rgba(255,255,255,.06);
  --panelBorder: rgba(255,255,255,.12);
  --text:#eaf1ff;
  --muted:#a9b7d6;
  --accent:#6ea8ff;
  --ok:#35d07f;
  --bad:#ff5a6a;
  --shadow: 0 10px 24px rgba(0,0,0,.30);
  --r:16px;
}
*{box-sizing:border-box}
body{
  margin:0;
  font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
  background: radial-gradient(1200px 600px at 30% 10%, #1a2a55 0%, var(--bg) 60%);
  color:var(--text);
}
header{
  max-width:1100px;
  margin:0 auto;
  padding:18px 14px 10px;
}
header h1{
  margin:0 0 6px;
  font-size:18px;
  letter-spacing:.2px;
}
header p{
  margin:0;
  font-size:13px;
  color:var(--muted);
  line-height:1.35;
}

.container{
  max-width:1100px;
  margin:0 auto;
  padding:0 14px 18px;
  display:flex;
  flex-direction:column;
  gap:12px;
}

.toolbar{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:10px;
  flex-wrap:wrap;
  background:var(--panel);
  border:1px solid var(--panelBorder);
  border-radius: var(--r);
  padding:10px;
  box-shadow: var(--shadow);
}

.btnRow{ display:flex; gap:8px; flex-wrap:wrap; }

button{
  border:0;
  cursor:pointer;
  padding:10px 14px;
  border-radius: 12px;
  background: rgba(110,168,255,.25);
  color:var(--text);
  font-weight:900;
  font-size:13px;
}
button.secondary{ background: rgba(255,255,255,.10); }
button:disabled{ opacity:.5; cursor:not-allowed; }

.pill{
  padding:8px 12px;
  border-radius:999px;
  background: rgba(255,255,255,.08);
  border:1px solid rgba(255,255,255,.12);
  font-weight:900;
  font-size:13px;
}
.hidden{ display:none !important; }

.helper{
  margin-top:10px;
  font-size:12px;
  color:var(--muted);
  display:flex;
  gap:8px;
  flex-wrap:wrap;
}
.helper .badge{
  border:1px solid rgba(255,255,255,.12);
  background: rgba(0,0,0,.18);
  border-radius:999px;
  padding:6px 10px;
  display:inline-flex;
  align-items:center;
  gap:8px;
}
.helper .dot{
  width:10px;height:10px;border-radius:50%;
  background: rgba(110,168,255,.85);
}

.layout{
  display:flex;
  flex-direction:column;
  gap:12px;
}

/* Category boxes */
.zone{
  background: var(--panel);
  border: 2px dashed rgba(110,168,255,.45);
  border-radius: var(--r);
  padding:12px;
  box-shadow: var(--shadow);
}

/* Stroke only (no tint) */
.zone.correct{ border-color: rgba(53,208,127,.95); }
.zone.wrong{ border-color: rgba(255,90,106,.95); }

.zoneHeader{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:10px;
  margin-bottom:10px;
}
.zoneTitle{
  font-size:15px;
  font-weight:1000;
  letter-spacing:.2px;
}
.zoneCount{
  font-size:12px;
  color:var(--muted);
  background: rgba(0,0,0,.15);
  border:1px solid rgba(255,255,255,.10);
  padding:6px 10px;
  border-radius:999px;
}

/* Tap target highlight */
.zone.tapTarget{
  outline:3px solid rgba(110,168,255,.55);
  outline-offset:2px;
}

/* Drop list */
.dropList{
  min-height: 90px;
  display:flex;
  flex-direction:column;
  gap:10px;
}

/* Chips */
.chip{
  background: #ffffff;
  color:#000000;
  border: 2px solid rgba(0,0,0,.12);
  border-radius: 14px;
  padding:12px 12px;
  font-weight:850;
  font-size:13px;
  line-height:1.25;
  cursor:pointer;
  user-select:none;
}
.chip.selected{
  border-color: rgba(110,168,255,.95);
  box-shadow: 0 12px 26px rgba(0,0,0,.25);
}

/* Individual marking: stroke only */
.chip.correctChip{ border-color: rgba(53,208,127,.95); }
.chip.wrongChip{ border-color: rgba(255,90,106,.95); }

/* Correct answer panel */
.key{
  background: rgba(0,0,0,.18);
  border: 1px solid rgba(255,255,255,.10);
  border-radius: var(--r);
  padding:12px;
  box-shadow: var(--shadow);
}
.key h3{
  margin:0 0 10px;
  font-size:14px;
  letter-spacing:.2px;
}
.keyBox{
  background: rgba(255,255,255,.06);
  border:1px solid rgba(255,255,255,.12);
  border-radius: 14px;
  padding:10px;
  margin-bottom:10px;
}
.keyTitle{
  font-weight:1000;
  margin-bottom:8px;
}
.keyList{
  margin:0;
  padding-left:18px;
  color:var(--text);
  font-size:13px;
  line-height:1.35;
}
.keyList li{ margin:6px 0; }

/* Bank */
.bankWrap{
  background: var(--panel);
  border:1px solid var(--panelBorder);
  border-radius: var(--r);
  padding:12px;
  box-shadow: var(--shadow);
}
.bankHeader{
  display:flex;
  align-items:baseline;
  justify-content:space-between;
  gap:10px;
  flex-wrap:wrap;
  margin-bottom:10px;
}
.bankTitle{
  font-weight:1000;
  font-size:14px;
}
.bankHint{
  font-size:12px;
  color:var(--muted);
}
.bank{
  display:flex;
  flex-direction:column;
  gap:10px;
}

@media (min-width: 900px){
  .layout{
    display:grid;
    grid-template-columns: 1fr 1fr;
    gap:12px;
    align-items:start;
  }
  .zonesColumn{ grid-column: 1 / 2; display:flex; flex-direction:column; gap:12px; }
  .rightColumn{ grid-column: 2 / 3; position:sticky; top:12px; display:flex; flex-direction:column; gap:12px; }
}

@media (max-width: 380px){
  header h1{ font-size:16px; }
  .chip{ font-size:12px; }
  button{ padding:10px 12px; }
}
</style>
</head>

<body>
<header>
  <h1>Categorize the Points</h1>
  <p>Tap a point, then tap a category box. Tap a point inside a box to return it to the bank. Tap <b>Check</b> to mark.</p>
</header>

<main class="container">
  <div class="toolbar">
    <div class="btnRow">
      <button id="check">Check</button>
      <button id="showKey" class="secondary" disabled>Show Correct Answers</button>
      <button id="reset" class="secondary">Reset</button>
    </div>
    <div class="pill hidden" id="score">Score: 0/0</div>
  </div>

  <section class="layout">
    <div class="zonesColumn">
      <div class="zone" data-zone="TS">
        <div class="zoneHeader">
          <div class="zoneTitle">Technical system</div>
          <div class="zoneCount" id="countTS">0 items</div>
        </div>
        <div class="dropList" data-drop-list="TS"></div>
      </div>

      <div class="zone" data-zone="MI">
        <div class="zoneHeader">
          <div class="zoneTitle">Management infrastructure</div>
          <div class="zoneCount" id="countMI">0 items</div>
        </div>
        <div class="dropList" data-drop-list="MI"></div>
      </div>

      <div class="zone" data-zone="MC">
        <div class="zoneHeader">
          <div class="zoneTitle">Mindsets and capabilities</div>
          <div class="zoneCount" id="countMC">0 items</div>
        </div>
        <div class="dropList" data-drop-list="MC"></div>
      </div>

      <div class="helper">
        <span class="badge"><span class="dot"></span> Step 1: Tap a point</span>
        <span class="badge"><span class="dot"></span> Step 2: Tap a category box</span>
        <span class="badge">Tap point in box = return to bank</span>
      </div>
    </div>

    <div class="rightColumn">
      <aside class="key hidden" id="answerKey">
        <h3>Correct Answers</h3>

        <div class="keyBox">
          <div class="keyTitle">Technical system</div>
          <ul class="keyList" id="keyTS"></ul>
        </div>

        <div class="keyBox">
          <div class="keyTitle">Management infrastructure</div>
          <ul class="keyList" id="keyMI"></ul>
        </div>

        <div class="keyBox">
          <div class="keyTitle">Mindsets and capabilities</div>
          <ul class="keyList" id="keyMC"></ul>
        </div>
      </aside>

      <aside class="bankWrap" id="bankWrap">
        <div class="bankHeader">
          <div class="bankTitle">Points (tap one)</div>
          <div class="bankHint">Then tap a category box to place it</div>
        </div>
        <div class="bank" id="bank"></div>
      </aside>
    </div>
  </section>
</main>

<script>
const ITEMS = [
  { id:"ts1", cat:"TS", text:"Mapping energy flow from coal yard to transformer (end-to-end) via theoretical limit analysis" },
  { id:"ts2", cat:"TS", text:"Identification of losses via comparison with plant design and state-of-the-art power plants" },
  { id:"ts3", cat:"TS", text:"Development of measures throughout four main operation areas (primary energy, boiler, turbine, auxiliaries)" },

  { id:"mi1", cat:"MI", text:"Build full energy efficiency KPI methodology and targets (broken down to key plant areas & leading KPIs)" },
  { id:"mi2", cat:"MI", text:"Include energy efficiency in shift handover meetings, and in station & fleet management meetings" },
  { id:"mi3", cat:"MI", text:"Create dedicated responsibilities by including energy efficiency in power station manager performance contract" },

  { id:"mc1", cat:"MC", text:"Building awareness and capabilities from top/middle management down to shop floor by involving the whole organization" }
];

const bank = document.getElementById("bank");
const scorePill = document.getElementById("score");
const btnShowKey = document.getElementById("showKey");
const answerKeyPanel = document.getElementById("answerKey");

const listTS = document.querySelector('[data-drop-list="TS"]');
const listMI = document.querySelector('[data-drop-list="MI"]');
const listMC = document.querySelector('[data-drop-list="MC"]');
const lists = { TS:listTS, MI:listMI, MC:listMC };

const zoneTS = document.querySelector('[data-zone="TS"]');
const zoneMI = document.querySelector('[data-zone="MI"]');
const zoneMC = document.querySelector('[data-zone="MC"]');
const zones = { TS:zoneTS, MI:zoneMI, MC:zoneMC };

/* Tap-select state */
let selectedChip = null;
let selectedItemId = null;
let hasChecked = false;

function clearSelection(){
  document.querySelectorAll(".chip.selected").forEach(c=>c.classList.remove("selected"));
  Object.values(zones).forEach(z=>z.classList.remove("tapTarget"));
  selectedChip = null;
  selectedItemId = null;
}

function markTargets(on){
  Object.values(zones).forEach(z=>{
    z.classList.toggle("tapTarget", on);
  });
}

function updateCounts(){
  const cTS = listTS.querySelectorAll(".chip").length;
  const cMI = listMI.querySelectorAll(".chip").length;
  const cMC = listMC.querySelectorAll(".chip").length;

  document.getElementById("countTS").textContent = `${cTS} item${cTS===1?"":"s"}`;
  document.getElementById("countMI").textContent = `${cMI} item${cMI===1?"":"s"}`;
  document.getElementById("countMC").textContent = `${cMC} item${cMC===1?"":"s"}`;
}

function clearZoneMarks(){
  Object.values(zones).forEach(z=>z.classList.remove("correct","wrong"));
}

function clearChipMarks(){
  document.querySelectorAll(".chip").forEach(ch=>{
    ch.classList.remove("correctChip","wrongChip");
  });
}

function hideAnswerKey(){
  answerKeyPanel.classList.add("hidden");
}

function buildAnswerKey(){
  const keyTS = document.getElementById("keyTS");
  const keyMI = document.getElementById("keyMI");
  const keyMC = document.getElementById("keyMC");
  keyTS.innerHTML = "";
  keyMI.innerHTML = "";
  keyMC.innerHTML = "";

  ITEMS.filter(i=>i.cat==="TS").forEach(i=>{
    const li=document.createElement("li"); li.textContent=i.text; keyTS.appendChild(li);
  });
  ITEMS.filter(i=>i.cat==="MI").forEach(i=>{
    const li=document.createElement("li"); li.textContent=i.text; keyMI.appendChild(li);
  });
  ITEMS.filter(i=>i.cat==="MC").forEach(i=>{
    const li=document.createElement("li"); li.textContent=i.text; keyMC.appendChild(li);
  });
}

/* Create chip that can be placed or returned */
function makeChip(item){
  const el = document.createElement("div");
  el.className = "chip";
  el.textContent = item.text;
  el.dataset.id = item.id;
  el.dataset.correct = item.cat;

  el.addEventListener("click", () => {
    // If clicked inside a zone: return to bank
    const parentList = el.closest(".dropList");
    if (parentList){
      bank.appendChild(el); // MOVE back
      el.classList.remove("correctChip","wrongChip","selected");
      updateCounts();

      // moving after check resets feedback
      if (hasChecked){
        clearZoneMarks();
        clearChipMarks();
        hideAnswerKey();
        scorePill.classList.add("hidden");
        btnShowKey.disabled = true;
        btnShowKey.textContent = "Show Correct Answers";
        hasChecked = false;
      }

      clearSelection();
      return;
    }

    // If clicked in bank: select/unselect
    if (selectedChip === el){
      clearSelection();
    } else {
      clearSelection();
      selectedChip = el;
      selectedItemId = el.dataset.id;
      el.classList.add("selected");
      markTargets(true);
    }
  });

  return el;
}

/* When user taps a category box after selecting a chip */
function placeSelectedInto(category){
  if (!selectedChip) return;

  lists[category].appendChild(selectedChip); // MOVE
  selectedChip.classList.remove("selected");
  clearSelection();
  updateCounts();

  // moving after check resets feedback
  if (hasChecked){
    clearZoneMarks();
    clearChipMarks();
    hideAnswerKey();
    scorePill.classList.add("hidden");
    btnShowKey.disabled = true;
    btnShowKey.textContent = "Show Correct Answers";
    hasChecked = false;
  }
}

/* Tap category zones */
zoneTS.addEventListener("click", ()=> placeSelectedInto("TS"));
zoneMI.addEventListener("click", ()=> placeSelectedInto("MI"));
zoneMC.addEventListener("click", ()=> placeSelectedInto("MC"));

/* Build / Reset */
function build(){
  bank.innerHTML = "";
  listTS.innerHTML = "";
  listMI.innerHTML = "";
  listMC.innerHTML = "";

  clearSelection();
  clearZoneMarks();
  clearChipMarks();
  hideAnswerKey();

  btnShowKey.disabled = true;
  btnShowKey.textContent = "Show Correct Answers";
  hasChecked = false;

  scorePill.classList.add("hidden");
  scorePill.textContent = `Score: 0/${ITEMS.length}`;

  ITEMS.slice().sort(()=>Math.random()-0.5).forEach(item=>{
    bank.appendChild(makeChip(item));
  });

  updateCounts();
  buildAnswerKey();
}

/* Check: no auto-correct. Zone green only if fully correct. Individual chips show green/red stroke. */
document.getElementById("check").onclick = () => {
  clearSelection();
  clearZoneMarks();
  clearChipMarks();
  hideAnswerKey();

  // pos map id -> TS/MI/MC/BANK
  const pos = {};
  ITEMS.forEach(i => pos[i.id] = "BANK");
  Object.entries(lists).forEach(([cat, list])=>{
    list.querySelectorAll(".chip").forEach(ch=>{
      pos[ch.dataset.id] = cat;
    });
  });

  // mark chips placed in TS/MI/MC
  let correctCount = 0;
  ["TS","MI","MC"].forEach(cat=>{
    lists[cat].querySelectorAll(".chip").forEach(ch=>{
      const id = ch.dataset.id;
      const correctCat = ITEMS.find(i=>i.id===id)?.cat;
      if (correctCat === cat){
        ch.classList.add("correctChip");
        correctCount++;
      } else {
        ch.classList.add("wrongChip");
      }
    });
  });

  // zone status: green only if ALL required present AND no wrong items
  ["TS","MI","MC"].forEach(cat=>{
    const requiredIds = ITEMS.filter(i=>i.cat===cat).map(i=>i.id);
    const placedIds = [...lists[cat].querySelectorAll(".chip")].map(ch=>ch.dataset.id);

    const hasWrong = placedIds.some(id => ITEMS.find(i=>i.id===id)?.cat !== cat);
    const missing = requiredIds.some(id => !placedIds.includes(id));

    zones[cat].classList.add((!hasWrong && !missing) ? "correct" : "wrong");
  });

  scorePill.textContent = `Score: ${correctCount}/${ITEMS.length}`;
  scorePill.classList.remove("hidden");

  hasChecked = true;
  btnShowKey.disabled = false;
};

/* Show correct answers (answer key only) */
btnShowKey.onclick = () => {
  if (!hasChecked) return;
  const willShow = answerKeyPanel.classList.contains("hidden");
  answerKeyPanel.classList.toggle("hidden");
  btnShowKey.textContent = willShow ? "Hide Correct Answers" : "Show Correct Answers";
};

/* Reset */
document.getElementById("reset").onclick = build;

build();
</script>
</body>
</html>
