<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Drag & Drop – Categorize Points (Mobile Friendly, No Image)</title>

<style>
:root{
  --bg:#0b1220;
  --panel: rgba(255,255,255,.06);
  --panelBorder: rgba(255,255,255,.12);
  --text:#eaf1ff;
  --muted:#a9b7d6;
  --accent:#6ea8ff;
  --ok:#35d07f;
  --bad:#ff5a6a;
  --shadow: 0 10px 24px rgba(0,0,0,.30);
  --r:16px;
}
*{box-sizing:border-box}
body{
  margin:0;
  font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
  background: radial-gradient(1200px 600px at 30% 10%, #1a2a55 0%, var(--bg) 60%);
  color:var(--text);
}
header{
  max-width:1100px;
  margin:0 auto;
  padding:18px 14px 10px;
}
header h1{
  margin:0 0 6px;
  font-size:18px;
  letter-spacing:.2px;
}
header p{
  margin:0;
  font-size:13px;
  color:var(--muted);
  line-height:1.35;
}

.container{
  max-width:1100px;
  margin:0 auto;
  padding:0 14px 18px;
  display:flex;
  flex-direction:column;
  gap:12px;
}

.toolbar{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:10px;
  flex-wrap:wrap;
  background:var(--panel);
  border:1px solid var(--panelBorder);
  border-radius: var(--r);
  padding:10px;
  box-shadow: var(--shadow);
}

.btnRow{ display:flex; gap:8px; flex-wrap:wrap; }

button{
  border:0;
  cursor:pointer;
  padding:10px 14px;
  border-radius: 12px;
  background: rgba(110,168,255,.25);
  color:var(--text);
  font-weight:900;
  font-size:13px;
}
button.secondary{ background: rgba(255,255,255,.10); }

.pill{
  padding:8px 12px;
  border-radius:999px;
  background: rgba(255,255,255,.08);
  border:1px solid rgba(255,255,255,.12);
  font-weight:900;
  font-size:13px;
}
.hidden{ display:none !important; }

.layout{
  display:flex;
  flex-direction:column;
  gap:12px;
}

/* Category boxes */
.zone{
  background: var(--panel);
  border: 2px dashed rgba(110,168,255,.45);
  border-radius: var(--r);
  padding:12px;
  box-shadow: var(--shadow);
}

.zoneHeader{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:10px;
  margin-bottom:10px;
}
.zoneTitle{
  font-size:15px;
  font-weight:1000;
  letter-spacing:.2px;
}
.zoneCount{
  font-size:12px;
  color:var(--muted);
  background: rgba(0,0,0,.15);
  border:1px solid rgba(255,255,255,.10);
  padding:6px 10px;
  border-radius:999px;
}

.zone.correct{
  border-color: rgba(53,208,127,.95);
  background: rgba(53,208,127,.10);
}
.zone.wrong{
  border-color: rgba(255,90,106,.95);
  background: rgba(255,90,106,.08);
}

.dropList{
  min-height: 90px;
  display:flex;
  flex-direction:column;
  gap:10px;
}

/* Chips */
.chip{
  background: rgba(255,255,255,.92);
  color:#0b1220;
  border: 1px solid rgba(0,0,0,.12);
  border-radius: 14px;
  padding:12px 12px;
  font-weight:850;
  font-size:13px;
  line-height:1.25;
  cursor:grab;
  user-select:none;
  touch-action:none;
}
.chip:active{ cursor:grabbing; }

/* ✅ Individual marking */
.chip.correctChip{
  border:2px solid rgba(53,208,127,.95);
  background: rgba(53,208,127,.20);
}
.chip.wrongChip{
  border:2px solid rgba(255,90,106,.95);
  background: rgba(255,90,106,.16);
}

/* Bank */
.bankWrap{
  background: var(--panel);
  border:1px solid var(--panelBorder);
  border-radius: var(--r);
  padding:12px;
  box-shadow: var(--shadow);
}
.bankHeader{
  display:flex;
  align-items:baseline;
  justify-content:space-between;
  gap:10px;
  flex-wrap:wrap;
  margin-bottom:10px;
}
.bankTitle{
  font-weight:1000;
  font-size:14px;
}
.bankHint{
  font-size:12px;
  color:var(--muted);
}
.bank{
  display:flex;
  flex-direction:column;
  gap:10px;
}

/* Tablet/desktop */
@media (min-width: 900px){
  .layout{
    display:grid;
    grid-template-columns: 1fr 1fr;
    gap:12px;
    align-items:start;
  }
  .zonesColumn{ grid-column: 1 / 2; display:flex; flex-direction:column; gap:12px; }
  .bankWrap{ grid-column: 2 / 3; position:sticky; top:12px; }
}

/* Small phones */
@media (max-width: 380px){
  header h1{ font-size:16px; }
  .chip{ font-size:12px; }
  button{ padding:10px 12px; }
}
</style>
</head>

<body>
<header>
  <h1>Categorize the Points</h1>
  <p>Drag each point into the correct category. Tap <b>Check</b> to mark. Boxes go green only when fully correct. Individual correct points also turn green.</p>
</header>

<main class="container">
  <div class="toolbar">
    <div class="btnRow">
      <button id="check">Check</button>
      <button id="reset" class="secondary">Reset</button>
    </div>
    <div class="pill hidden" id="score">Score: 0/0</div>
  </div>

  <section class="layout">
    <div class="zonesColumn">
      <div class="zone" data-zone="TS">
        <div class="zoneHeader">
          <div class="zoneTitle">Technical system</div>
          <div class="zoneCount" id="countTS">0 items</div>
        </div>
        <div class="dropList" data-drop-list="TS"></div>
      </div>

      <div class="zone" data-zone="MI">
        <div class="zoneHeader">
          <div class="zoneTitle">Management infrastructure</div>
          <div class="zoneCount" id="countMI">0 items</div>
        </div>
        <div class="dropList" data-drop-list="MI"></div>
      </div>

      <div class="zone" data-zone="MC">
        <div class="zoneHeader">
          <div class="zoneTitle">Mindsets and capabilities</div>
          <div class="zoneCount" id="countMC">0 items</div>
        </div>
        <div class="dropList" data-drop-list="MC"></div>
      </div>
    </div>

    <aside class="bankWrap">
      <div class="bankHeader">
        <div class="bankTitle">Points (drag from here)</div>
        <div class="bankHint">Move (not copy). Re-drag to another box anytime.</div>
      </div>
      <div class="bank" id="bank"></div>
    </aside>
  </section>
</main>

<script>
const ITEMS = [
  { id:"ts1", cat:"TS", text:"Mapping energy flow from coal yard to transformer (end-to-end) via theoretical limit analysis" },
  { id:"ts2", cat:"TS", text:"Identification of losses via comparison with plant design and state-of-the-art power plants" },
  { id:"ts3", cat:"TS", text:"Development of measures throughout four main operation areas (primary energy, boiler, turbine, auxiliaries)" },

  { id:"mi1", cat:"MI", text:"Build full energy efficiency KPI methodology and targets (broken down to key plant areas & leading KPIs)" },
  { id:"mi2", cat:"MI", text:"Include energy efficiency in shift handover meetings, and in station & fleet management meetings" },
  { id:"mi3", cat:"MI", text:"Create dedicated responsibilities by including energy efficiency in power station manager performance contract" },

  { id:"mc1", cat:"MC", text:"Building awareness and capabilities from top/middle management down to shop floor by involving the whole organization" }
];

const bank = document.getElementById("bank");
const scorePill = document.getElementById("score");

const listTS = document.querySelector('[data-drop-list="TS"]');
const listMI = document.querySelector('[data-drop-list="MI"]');
const listMC = document.querySelector('[data-drop-list="MC"]');
const lists = { TS:listTS, MI:listMI, MC:listMC };

const zoneTS = document.querySelector('[data-zone="TS"]');
const zoneMI = document.querySelector('[data-zone="MI"]');
const zoneMC = document.querySelector('[data-zone="MC"]');
const zones = { TS:zoneTS, MI:zoneMI, MC:zoneMC };

let draggedEl = null;

function makeChip(item){
  const el = document.createElement("div");
  el.className = "chip";
  el.textContent = item.text;
  el.draggable = true;
  el.dataset.id = item.id;
  el.dataset.correct = item.cat;

  el.ondragstart = (e) => {
    draggedEl = el;
    e.dataTransfer.setData("text/plain", item.id);
  };
  return el;
}

function updateCounts(){
  const cTS = listTS.querySelectorAll(".chip").length;
  const cMI = listMI.querySelectorAll(".chip").length;
  const cMC = listMC.querySelectorAll(".chip").length;

  document.getElementById("countTS").textContent = `${cTS} item${cTS===1?"":"s"}`;
  document.getElementById("countMI").textContent = `${cMI} item${cMI===1?"":"s"}`;
  document.getElementById("countMC").textContent = `${cMC} item${cMC===1?"":"s"}`;
}

function clearZoneMarks(){
  Object.values(zones).forEach(z=>z.classList.remove("correct","wrong"));
}

function clearChipMarks(){
  document.querySelectorAll(".chip").forEach(ch=>{
    ch.classList.remove("correctChip","wrongChip");
  });
}

function setupDropTarget(container){
  container.ondragover = (e) => e.preventDefault();
  container.ondrop = (e) => {
    e.preventDefault();
    if(!draggedEl) return;

    container.appendChild(draggedEl); // MOVE
    draggedEl = null;

    // When moving again, remove marks so they can try again cleanly
    clearZoneMarks();
    clearChipMarks();
    updateCounts();
  };
}

function build(){
  bank.innerHTML = "";
  listTS.innerHTML = "";
  listMI.innerHTML = "";
  listMC.innerHTML = "";
  clearZoneMarks();
  clearChipMarks();

  scorePill.classList.add("hidden");
  scorePill.textContent = `Score: 0/${ITEMS.length}`;

  ITEMS.slice().sort(()=>Math.random()-0.5).forEach(item=>{
    bank.appendChild(makeChip(item));
  });

  updateCounts();
}

/* Drop targets */
setupDropTarget(listTS);
setupDropTarget(listMI);
setupDropTarget(listMC);
setupDropTarget(bank);

/* Check: (1) zone green only if fully correct, (2) individual correct chips green even if zone is red */
document.getElementById("check").onclick = () => {
  clearZoneMarks();
  clearChipMarks();

  // Build position map id -> current container key (TS/MI/MC/BANK)
  const pos = {};
  ITEMS.forEach(i => pos[i.id] = "BANK");

  Object.entries(lists).forEach(([cat, list])=>{
    list.querySelectorAll(".chip").forEach(ch=>{
      pos[ch.dataset.id] = cat;
    });
  });

  // Mark individual chips correct/incorrect (only those placed in TS/MI/MC)
  let correctCount = 0;

  ["TS","MI","MC"].forEach(cat=>{
    const list = lists[cat];
    list.querySelectorAll(".chip").forEach(ch=>{
      const id = ch.dataset.id;
      const correctCat = ITEMS.find(i=>i.id===id)?.cat;
      if (correctCat === cat){
        ch.classList.add("correctChip");
        correctCount++;
      } else {
        ch.classList.add("wrongChip");
      }
    });
  });

  // Zone logic: green ONLY if all required are present AND no wrong chips in zone
  ["TS","MI","MC"].forEach(cat=>{
    const requiredIds = ITEMS.filter(i=>i.cat===cat).map(i=>i.id);
    const placedIds = [...lists[cat].querySelectorAll(".chip")].map(ch=>ch.dataset.id);

    const hasWrong = placedIds.some(id => ITEMS.find(i=>i.id===id)?.cat !== cat);
    const missing = requiredIds.some(id => !placedIds.includes(id));

    zones[cat].classList.add((!hasWrong && !missing) ? "correct" : "wrong");
  });

  // Auto-correct: move any item not in its correct category into correct category
  // BUT keep individual marking visible: we'll re-mark after move.
  ITEMS.forEach(item=>{
    if (pos[item.id] !== item.cat){
      let el = document.querySelector(`.chip[data-id="${item.id}"]`);
      if (!el) el = makeChip(item);
      lists[item.cat].appendChild(el);
    }
  });

  // Re-mark chips after auto-correct so users see final correct placement in green
  clearChipMarks();
  ["TS","MI","MC"].forEach(cat=>{
    lists[cat].querySelectorAll(".chip").forEach(ch=>{
      const id = ch.dataset.id;
      const correctCat = ITEMS.find(i=>i.id===id)?.cat;
      if (correctCat === cat) ch.classList.add("correctChip");
      else ch.classList.add("wrongChip");
    });
  });

  updateCounts();

  scorePill.textContent = `Score: ${correctCount}/${ITEMS.length}`;
  scorePill.classList.remove("hidden");
};

document.getElementById("reset").onclick = build;

build();
</script>
</body>
</html>
